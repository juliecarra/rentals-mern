{"ast":null,"code":"import axios from \"axios\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport jwt_decode from \"jwt-decode\";\nimport { FETCH_RENTALS_INIT, FETCH_RENTALS, FETCH_RENTALS_BY_ID, DELETE_RENTAL, GET_ERRORS, SET_CURRENT_USER, FETCH_BOOKINGS_INIT, FETCH_BOOKINGS } from \"./types\"; //rentals actions\n\nexport const fetchRentals = city => async dispatch => {\n  try {\n    const url = city ? `/api/rentals?city=${city}` : \"/api/rentals\";\n    dispatch({\n      type: FETCH_RENTALS_INIT\n    });\n    const res = await axios.get(url); // debugger;\n\n    dispatch({\n      type: FETCH_RENTALS,\n      payload: res.data\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\nexport const fetchRentalsById = rentalId => async dispatch => {\n  const res = await axios.get(`/api/rentals/${rentalId}`);\n  dispatch({\n    type: FETCH_RENTALS_BY_ID,\n    payload: res.data\n  });\n};\nexport const createRental = (rentalData, history) => async dispatch => {\n  try {\n    await axios.post(\"/api/rentals\", rentalData);\n    history.push(\"/\");\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: null\n    });\n  }\n};\nexport const fetchUserRentals = () => async dispatch => {\n  try {\n    const res = await axios.get(\"/api/rentals/manage\");\n    dispatch({\n      type: FETCH_RENTALS,\n      payload: res.data\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\nexport const deleteRental = id => async dispatch => {\n  try {\n    await axios.delete(`/api/rentals/${id}`);\n    dispatch({\n      type: DELETE_RENTAL,\n      payload: id\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n}; // user actions\n\nexport const registerUser = (userData, history) => async dispatch => {\n  try {\n    await axios.post(\"/api/users/signup\", userData);\n    history.push(\"/login\"); //If we manage to register, we are redirected to login\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\nexport const loginUser = userData => async dispatch => {\n  try {\n    const res = await axios.post(\"/api/users/login\", userData); // Save to localStorage\n\n    const {\n      token\n    } = res.data; // Set token to ls\n\n    localStorage.setItem(\"jwtToken\", token); // Set token to Auth header\n\n    setAuthToken(token); // Decode token to get user data\n\n    const decoded = jwt_decode(token); // Set current user\n\n    dispatch(setCurrentUser(decoded));\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\nexport const setCurrentUser = decoded => {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded\n  };\n};\nexport const logoutUser = () => dispatch => {\n  // Remove token from localStorage\n  localStorage.removeItem(\"jwtToken\"); // Remove auth header for future requests\n\n  setAuthToken(false); // Set current user to {} which will set isAuthenticated to false\n\n  dispatch(setCurrentUser({}));\n}; //booking actions\n\nexport const createBooking = booking => async dispatch => {\n  try {\n    const res = await axios.post(\"/api/bookings\", booking);\n    debugger;\n    dispatch({\n      payload: res.data\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\nexport const fetchUserBookings = () => async dispatch => {\n  dispatch({\n    type: FETCH_BOOKINGS_INIT\n  });\n\n  try {\n    const res = await axios.get(\"/api/bookings/manage\"); // debugger;\n\n    dispatch({\n      type: FETCH_BOOKINGS,\n      payload: res.data\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}; // Payments actions\n\nexport const getPendingPayments = () => {\n  debugger;\n  return axios.get(\"/api/payments/pending\").then(res => res.data).catch(({\n    response\n  }) => Promise.reject(response.data.errors));\n};\nexport const acceptPayment = payment => {\n  return axios.post(\"/api/payments/confirm\", payment).then(res => res.data).catch(({\n    response\n  }) => Promise.reject(response.data.errors));\n};\nexport const declinePayment = payment => {\n  return axios.post(\"/api/payments/decline\", payment).then(res => res.data).catch(({\n    response\n  }) => Promise.reject(response.data.errors));\n};","map":{"version":3,"sources":["/Users/Julie-Marie-Carra/Desktop/Udemy/server/client/src/actions/index.js"],"names":["axios","setAuthToken","jwt_decode","FETCH_RENTALS_INIT","FETCH_RENTALS","FETCH_RENTALS_BY_ID","DELETE_RENTAL","GET_ERRORS","SET_CURRENT_USER","FETCH_BOOKINGS_INIT","FETCH_BOOKINGS","fetchRentals","city","dispatch","url","type","res","get","payload","data","error","response","fetchRentalsById","rentalId","createRental","rentalData","history","post","push","fetchUserRentals","deleteRental","id","delete","registerUser","userData","loginUser","token","localStorage","setItem","decoded","setCurrentUser","logoutUser","removeItem","createBooking","booking","fetchUserBookings","console","log","getPendingPayments","then","catch","Promise","reject","errors","acceptPayment","payment","declinePayment"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport jwt_decode from \"jwt-decode\";\n\nimport {\n  FETCH_RENTALS_INIT,\n  FETCH_RENTALS,\n  FETCH_RENTALS_BY_ID,\n  DELETE_RENTAL,\n  GET_ERRORS,\n  SET_CURRENT_USER,\n  FETCH_BOOKINGS_INIT,\n  FETCH_BOOKINGS\n} from \"./types\";\n\n//rentals actions\nexport const fetchRentals = city => async dispatch => {\n  try {\n    const url = city ? `/api/rentals?city=${city}` : \"/api/rentals\";\n\n    dispatch({ type: FETCH_RENTALS_INIT });\n\n    const res = await axios.get(url);\n    // debugger;\n    dispatch({ type: FETCH_RENTALS, payload: res.data });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\nexport const fetchRentalsById = rentalId => async dispatch => {\n  const res = await axios.get(`/api/rentals/${rentalId}`);\n  dispatch({ type: FETCH_RENTALS_BY_ID, payload: res.data });\n};\n\nexport const createRental = (rentalData, history) => async dispatch => {\n  try {\n    await axios.post(\"/api/rentals\", rentalData);\n    history.push(\"/\");\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: null\n    });\n  }\n};\n\nexport const fetchUserRentals = () => async dispatch => {\n  try {\n    const res = await axios.get(\"/api/rentals/manage\");\n    dispatch({ type: FETCH_RENTALS, payload: res.data });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\nexport const deleteRental = id => async dispatch => {\n  try {\n    await axios.delete(`/api/rentals/${id}`);\n    dispatch({\n      type: DELETE_RENTAL,\n      payload: id\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\n// user actions\nexport const registerUser = (userData, history) => async dispatch => {\n  try {\n    await axios.post(\"/api/users/signup\", userData);\n    history.push(\"/login\"); //If we manage to register, we are redirected to login\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\nexport const loginUser = userData => async dispatch => {\n  try {\n    const res = await axios.post(\"/api/users/login\", userData);\n\n    // Save to localStorage\n    const { token } = res.data;\n    // Set token to ls\n    localStorage.setItem(\"jwtToken\", token);\n    // Set token to Auth header\n    setAuthToken(token);\n    // Decode token to get user data\n    const decoded = jwt_decode(token);\n    // Set current user\n    dispatch(setCurrentUser(decoded));\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\nexport const setCurrentUser = decoded => {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded\n  };\n};\n\nexport const logoutUser = () => dispatch => {\n  // Remove token from localStorage\n  localStorage.removeItem(\"jwtToken\");\n  // Remove auth header for future requests\n  setAuthToken(false);\n  // Set current user to {} which will set isAuthenticated to false\n  dispatch(setCurrentUser({}));\n};\n\n//booking actions\nexport const createBooking = booking => async dispatch => {\n  try {\n    const res = await axios.post(\"/api/bookings\", booking);\n    debugger;\n    dispatch({ payload: res.data });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n\nexport const fetchUserBookings = () => async dispatch => {\n  dispatch({ type: FETCH_BOOKINGS_INIT });\n  try {\n    const res = await axios.get(\"/api/bookings/manage\");\n    // debugger;\n    dispatch({ type: FETCH_BOOKINGS, payload: res.data });\n  } catch (error) {\n    console.log(error);\n  }\n};\n\n// Payments actions\nexport const getPendingPayments = () => {\n  debugger;\n  return axios\n    .get(\"/api/payments/pending\")\n    .then(res => res.data)\n    .catch(({ response }) => Promise.reject(response.data.errors));\n};\n\nexport const acceptPayment = payment => {\n  return axios\n    .post(\"/api/payments/confirm\", payment)\n    .then(res => res.data)\n    .catch(({ response }) => Promise.reject(response.data.errors));\n};\n\nexport const declinePayment = payment => {\n  return axios\n    .post(\"/api/payments/decline\", payment)\n    .then(res => res.data)\n    .catch(({ response }) => Promise.reject(response.data.errors));\n};\n"]},"metadata":{},"sourceType":"module"}